
```{r, include=FALSE}
library(tidyverse)



fg_db <- dplyr::src_mysql(dbname = Sys.getenv("FG_DB"), 
                            host = Sys.getenv("FG_HOST"), 
                            user = Sys.getenv("FG_USER"),
                            password = Sys.getenv("FG_PW"))

fg_players <- fg_db %>%
  tbl("player_info") %>%
  collect(n=Inf)

fg_pitch <- fg_db %>%
  tbl("stats_pitching_master_pfx") %>%
  filter(Type == 0,
         Season >= 2000) %>%     #get only full-season stats for each player
  collect(n=Inf)

fg_pitchers <- inner_join(fg_players, fg_pitch, by="PlayerId") %>%
  mutate(Name = sprintf("%s %s", FirstName, LastName)) %>%
  filter(BISPosition == "SP",
         TBF >= 100)

fgt = theme(panel.background=element_rect(color="lightgrey",fill="white"), axis.title = element_text(family="Lato"), axis.text = element_text(family="Lato"), legend.title = element_text(family="Lato"), legend.text = element_text(family="Lato"), legend.background = element_rect(fill="white"), legend.key = element_rect(fill="white"), plot.title = element_text(family="Lato"), panel.grid.major=element_line(size=.1,color="lightgrey"), panel.grid.minor=element_line(size=0))

```

# Four Reasons A's Fans Should be Optimistic about Sean Manaea

Oakland A's fans didn't have many reasons to be optimistic in 2016. The team's playoff odds peaked at 20% ... on April 3rd. As the season wore on, Sonny Gray's ERA spiked almost as high as the home runs against him flew. The 69-93 final record was the icing on the cake.  

Sean Manaea provided one bright spot. Acquired from Kansas City in 2015 in exchange for Ben Zobrist, Manaea is a 6'5", 245-pound lefty. He debuted in April and, following some tweaks to his change-up grip [http://www.fangraphs.com/blogs/sean-manaea-checking-them-off/], remained in the rotation the entire season. He gave up more than his fair share of home runs, but his 14.7 K-BB% proved he could fool batters. His 93 xFIP- ranked alongside that of Rookie of the Year Michael Fulmer.

2017 doesn't look any rosier for the Athletics as a whole. Our Depth Charts projections have them bringing up the rear in the AL West again. But at least the team's fans can be optimistic Manaea will perform well in 2017, for four very good reasons:

## 1. Excellent Swinging-Strike Rate

When batters swung at a pitch from Manaea, they missed 11.8% of the time. This rate ranks Manaea at the 91st percentile among starters who faced at least 100 batters last year: 

```{r, echo=FALSE}
swstr <- fg_pitchers %>%
  filter(Season == 2016) %>%
  select(Name, swstr = `SwStr%`) %>%
  arrange(desc(swstr)) %>%
  mutate(`SwStr%` = round(swstr * 100, 1),
         `MLB Rank` = round(percent_rank(`SwStr%`) * 100, 1)) %>%
  select(Name, `SwStr%`, `MLB Rank`) %>%
  filter(`SwStr%` >= 11.0,
         `SwStr%` <= 13.0) %>%
  arrange(desc(`MLB Rank`)) %>%
  head(20) %>%
  write_csv("manaea-swstr-table.csv")

knitr::kable(swstr)
```

Manaea's peers here are Justin Verlander, David Price, and James Paxton: good pitchers, all. Manaea got swings and misses more frequently than Madison Bumgarner and Chris Sale, among others.

What about 2017? Swinging-strike rate correlates very well year-to-year (r = 0.69), as the following graph shows:

```{r, echo = FALSE}
swstr_corr <- fg_pitchers %>%
  select(PlayerId, Name, Season, swstr = `SwStr%`) %>%
  group_by(PlayerId) %>%
  arrange(PlayerId, Season) %>%
  mutate(`SwStr% Year N` = 100 * swstr,
         `SwStr% Year N+1`= lead(`SwStr% Year N`)) %>%
  filter(!is.na(`SwStr% Year N`),
         !is.na(`SwStr% Year N+1`)) %>%
  ungroup() %>%
  select(`SwStr% Year N`, `SwStr% Year N+1`) %>%
  write_csv("manaea-swstr-plot.csv")

ggplot(swstr_corr, aes(`SwStr% Year N`, `SwStr% Year N+1`)) + geom_point() + geom_smooth(method = "lm") + fgt + ggtitle("Swinging-Strike Rate Year-to-Year Correlation, Starters >= 100 IP 2014 - 2016")

#swstr_model <- lm(swstr_corr$next_swstr ~ swstr_corr$swstr)

#remember this is 2014-2016 starters who faced at least 100 batters in a season
```

This graph shows fans can expect Manaea to induce a similar swinging-strike rate in 2017.

## 2. Very Good Walk Rate 

Manaea's walk rate isn't as excellent as his swinging-strike rate, but at 6.2% (75th percentile), his walk rate holds up well.

```{r, echo = FALSE}
walk_rate <- fg_pitchers %>%
  filter(Season == 2016) %>%
  select(Name, bb = `BB%`) %>%
  mutate(`BB%` = round(100 * bb, 1),
         `MLB Rank` = round(100 * percent_rank(desc(`BB%`)), 1)) %>%
  select(-bb) %>%
  filter(`BB%` >= 6.1,
         `BB%` <= 6.3) %>%
  arrange(desc(`MLB Rank`)) %>%
  write_csv("manaea-walk-rate-table.csv")

knitr::kable(walk_rate)
  
```

Kevin Gausman is a good comp, as are Matt Harvey and Max Scherzer.

What's in store for next year? Walk rate correlates moderately well (r = 0.56) year-to-year:

```{r, echo = FALSE}
bb_corr <- fg_pitchers %>%
  select(PlayerId, Name, Season, `BB% Year N` = `BB%`) %>%
  group_by(PlayerId) %>%
  arrange(PlayerId, Season) %>%
  mutate(`BB% Year N` = 100 * `BB% Year N`,
         `BB% Year N+1`= lead(`BB% Year N`)) %>%
  filter(!is.na(`BB% Year N`),
         !is.na(`BB% Year N+1`)) %>%
  ungroup() %>%
  select(`BB% Year N`, `BB% Year N+1`) %>%
  write_csv("manaea-walk-rate-plot.csv")

ggplot(bb_corr, aes(`BB% Year N`, `BB% Year N+1`)) + geom_point() + geom_smooth(method = "lm") + fgt + ggtitle("Walk Rate Year-to-Year Correlation, Starters >= 100 IP, 2000 - 2016")
```

Perhaps this moderate correlation is why Steamer forecasts a sharp 1.7 point rise in walk rate for Manaea next year. Still, starting from a 6.2% walk rate is a good position.

## 3. High HR/FB Rate

Wait, why is Manaea's 13.7 HR/FB rate a good thing? Because regression to the mean tells us this rate probably won't be so high next year. The following graph shows year N and year N+1 HR/FB rates for Athletics starters since 2000 who've faced at least 100 batters in a season:    

```{r, echo = FALSE}
athletics_hr_fb <- fg_pitchers %>%
  filter(TeamId.x == 10) %>%
  select(PlayerId, Name, TeamId = TeamId.x, Season, `HR/FB Year N` = `HR/FB`) %>%
  group_by(PlayerId) %>%
  arrange(PlayerId, Season) %>%
  mutate(`HR/FB Year N` = 100 * `HR/FB Year N`,
         `HR/FB Year N+1` = lead(`HR/FB Year N`)) %>%
  filter(!is.na(`HR/FB Year N`),
         !is.na(`HR/FB Year N+1`)) %>%
  ungroup() %>%
  select(`HR/FB Year N`, `HR/FB Year N+1`) %>%
  write_csv("manaea-hrfb-plot.csv")

ggplot(athletics_hr_fb, aes(`HR/FB Year N`, `HR/FB Year N+1`)) + geom_point() + geom_smooth(method = "lm") + fgt

#since 2002

```

I looked at only A's starters here to somewhat adjust for park, which influences home run rate. Regardless, no correlation is present (r = 0.12). Don't expect Manaea to repeat his dinger-friendly ways in 2017.

## 4. Top-Five O-Swing%

The best reason to be optimistic about Sean Manaea is this: last year he induced hitters to offer at 36.5% of his pitches out of the zone. This rate ranks in the 98th percentile among starters who faced at least 100 batters last year:

```{r, echo = FALSE}
oswing_plt_chart <- fg_pitchers %>%
  filter(Season == 2016) %>%
  select(Name, `O-Swing%` = `pfxO-Swing%`) %>%
  mutate(`O-Swing%` = round(100 * `O-Swing%`, 1),
         `MLB Rank` = round(percent_rank(`O-Swing%`) * 100, 1)) %>%
  arrange(desc(`MLB Rank`)) %>%
  head(15) %>%
  write_csv("manaea-oswing-table.csv")

knitr::kable(oswing_plt_chart)

```

Manaea ranks just about equal with Thor here and ahead of Corey Kluber, Carlos Carrasco, and Max Scherzer.

Why is O-Swing% important? Data from Baseball Savant shows that swinging at pitches out of the zone results in a much lower ISO than swinging at piches in the zone:

```{r, echo = FALSE}
iso_by_location <- read_csv("iso on batted ball location - Sheet1.csv", 
                            col_types = list(col_character(), col_character(), col_double()))

#iso_by_location$Year = as.character(iso_by_location$Year)

ggplot(iso_by_location, aes(x=Year, y=`Avg. ISO on Swing`, color=`Pitch Location`)) + geom_line(aes(group=`Pitch Location`)) + geom_point() + scale_y_continuous(labels= function(x){
  sprintf("%.3f", x)
}) + fgt + ggtitle("Hitters Shouldn't Chase Pitches Out of the Zone.")
```

Manaea's high O-Swing% bodes well for suppressing power, especially in Oakland. This is another reason to suspect his HR/FB rate will drop next year.

Manaea should continue to induce swings out of the zone next year. The data show a moderate correlation (r = 0.57) between O-Swing rates year-to-year:

```{r, echo = FALSE}
oswing_corr <- fg_pitchers %>%
  select(PlayerId, Name, Season, `O-Swing% Year N` = `pfxO-Swing%`) %>%
  group_by(PlayerId) %>%
  arrange(PlayerId, Season) %>%
  mutate(`O-Swing% Year N` = 100 * `O-Swing% Year N`,
    `O-Swing% Year N+1` = lead(`O-Swing% Year N`)) %>%
  filter(!is.na(`O-Swing% Year N`),
         !is.na(`O-Swing% Year N+1`)) %>%
  ungroup() %>%
  select(`O-Swing% Year N`, `O-Swing% Year N+1`) %>%
  write_csv("manaea-oswing-plot.csv")

ggplot(oswing_corr, aes(`O-Swing% Year N`, `O-Swing% Year N+1`)) + geom_point() + geom_smooth(method = "lm") + fgt

#since 2007

```

## Conclusion

If 2016 is any indication, fans can expect Sean Manea to induce a lot of swings like this in 2017:


He won't anchor the rotation, but Manaea should ...



```
