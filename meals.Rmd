---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(googlesheets4)
library(lubridate)
library(glue)
```

```{r}
meal_data <-
  read_sheet("https://docs.google.com/spreadsheets/d/1RBvCN7sc1CgGTVH9mnHADmJ6OflK0mAFMJGLt60CXog/edit#gid=0") %>%
  filter(!is.na(Main)) %>%
  dplyr::select(meal = Main, last_eaten = `Last Eaten`) %>%
  mutate(meal = tolower(meal),
         last_eaten = ymd(last_eaten),
    month_eaten = floor_date(last_eaten, unit = "month"),
    protein = str_extract(meal, "steak|chicken breast|chicken thigh|chicken|pork|sausage|beef|turkey|bacon|chorizo|fish|tilapia|barbacoa|ribs"),
    side = str_extract(meal, "(w/|with|\\+).*"),
protein = str_replace_all(protein, c("chicken breast" = "chicken",
                             "chicken thigh" = "chicken",
                             "beef" = "ground beef",
                             "ribs" = "pork")),
method = str_extract(meal, "ip|instant pot|slow cooker|crock pot|roast|sautee|sous vide")) %>%
  replace_na(list(protein = "none",
                  method = "none specified"))
         
meal_data %>%
  count(month_eaten, protein) %>%
  complete(month_eaten, protein, fill = list(n=0)) %>%
  ggplot(aes(month_eaten, n, fill = protein)) + geom_area()

meal_data %>%
  count(protein, sort = TRUE) %>%
  ggplot(aes(reorder(protein, n), n)) + geom_col() + coord_flip() +
  labs(x="", y = "number of meals made")
  
meal_data %>% 
  count(meal, sort = TRUE)

# how long has it been since i last made each meal?s
meal_data %>%
  group_by(meal) %>%
  filter(last_eaten == max(last_eaten)) %>%
  mutate(days_since_cooked = difftime(Sys.Date(), last_eaten, unit = "days")) %>%
  select(meal, last_eaten, days_since_cooked) %>%
  arrange(desc(days_since_cooked)) %>%
  View()


```


PS5 playtime in 2021 

```{r}
games_played_2021 <-
  tribble(
  ~game, ~hours_played,
  "Mass Effect: Legendary Edition", 5,
  "Guardians of the Galaxy", 19,
  "Star Wars: Squadrons", 167,
  "NieR: Automata GotY Edition", 27,
  "Tales of Arise", 59,
  "Bloodborne + The Old Hunters DLC", 99,
  "Returnal", 5,
  "Dark Souls II: Scholar of the First Sin", 17,
  "Dark Souls: Remastered + Artorias of the Abyss DLC", 33,
  "Demon's Souls", 29,
  "Death Stranding", 70,
  "Astro's Playroom", 2,
  "Resident Evil Village", 17,
  "Resident Evil 7 Biohazard", 13,
  "Genshin Impact", 29,
  "God of War III Remastered", 12,
  "God of War (2018)", 20,
  "Dragon Quest XI", 12,
  "Borderlands: The Handsome Collection", 5,
  "Borderlands: GotY Edition", 17
)

hours_played <- sum(games_played_2021$hours_played)

games_played_2021 %>%
  ggplot(aes(reorder(game, hours_played), hours_played)) +
  geom_col() + coord_flip() +
  ggtitle("PS4/5 Games Played, 2021", subtitle = glue("{hours_played} total hours")) +
  labs(x="", caption = "Source: PS5 Profile")

```


